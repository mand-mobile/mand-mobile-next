import{D as e}from"./index.44046f1d.js";import{_ as t}from"./index.93932acd.js";import{t as o}from"./index.0698aebd.js";import{u as n}from"./show.c01af516.js";import"./animate.d048e3d3.js";import{b as a,H as s,S as d,h as l}from"./constants.3b37bb64.js";import{m as c,P as r,D as u,B as i,d as p,r as m,o as f,c as h,w as x,f as w,t as g,l as v,n as b,i as y,g as S}from"./vendor.cf144a98.js";const C={title:{type:String},brief:{type:String,default:""},content:{type:String,default:""},visible:{type:Boolean,default:!1},maxlength:{type:Number,default:4},mask:{type:Boolean,default:!1},system:{type:Boolean,default:!1},autoSend:{type:Boolean,default:!0},autoCountdown:{type:Boolean,default:!0},count:{type:Number,default:60},countNormalText:{type:String,default:o("md.captcha.sendCaptcha")},countActiveText:{type:String,default:o("md.captcha.countdown")},isView:{type:Boolean,default:!1}},H=(e,{emit:t})=>{const{popupShow:o,onShow:a,onHide:s,hide:d}=n(e,t),p=c(null),m=c("");r((()=>{m.value.length===e.maxlength&&t(l,m.value)}));const f=c(!1),h=c("");let x,w=e.count;const g=()=>{w&&(f.value=!0,h.value=e.countActiveText.replace("{$1}",`${w}`),x=globalThis.setInterval((()=>{w<=1?v():(w-=1,h.value=e.countActiveText.replace("{$1}",`${w}`))}),1e3))},v=()=>{f.value=!1,h.value=e.countNormalText,clearInterval(x)},b=c(""),y=()=>{e.autoSend&&(t("send",g),e.autoCountdown&&g())},S=i(o,(e=>{e&&y(),S()}));return{popupShow:o,onShow:()=>{p.value.focusHandler(),a()},onHide:()=>{m.value="",s()},hide:d,code:m,errorMsg:b,countBtnText:h,isCounting:f,codeboxRef:p,countdown:g,setError:e=>{u((()=>{b.value=e}))},sendHandler:y}};var B=p({name:"MdCaptcha",components:{MdDialog:e,MdCodebox:t},props:C,emits:[a,s,d,l,"send"],setup(e,t){const{popupShow:o,onShow:n,onHide:a,code:s,errorMsg:d,countBtnText:l,isCounting:c,codeboxRef:r,countdown:u,setError:i,sendHandler:p}=H(e,t);return{popupShow:o,onShow:n,onHide:a,code:s,errorMsg:d,countBtnText:l,isCounting:c,codebox:r,countdown:u,setError:i,sendHandler:p}}});const T={class:"md-captcha-content"},k={class:"md-captcha-message"},M={class:"md-captcha-footer"};B.render=function(e,t,o,n,a,s){const d=m("md-codebox");return f(),h(y(e.isView?"div":"MdDialog"),{modelValue:e.popupShow,"onUpdate:modelValue":t[3]||(t[3]=t=>e.popupShow=t),class:"md-captcha",onShow:e.onShow,onHide:e.onHide},{default:x((()=>[w("div",T,[e.title?(f(),h("p",{key:0,class:"md-captcha-title",textContent:g(e.title)},null,8,["textContent"])):v("",!0),w("div",k,[b(e.$slots,"default",{},(()=>[S(g(e.content),1)]))])]),w(d,{ref:"codebox",modelValue:e.code,"onUpdate:modelValue":t[2]||(t[2]=t=>e.code=t),maxlength:e.maxlength,system:e.system,mask:e.mask,justify:!0,"is-view":e.isView},{default:x((()=>[w("footer",M,[e.errorMsg?(f(),h("div",{key:0,class:"md-captcha-error",textContent:g(e.errorMsg)},null,8,["textContent"])):(f(),h("div",{key:1,class:"md-captcha-brief",textContent:g(e.brief)},null,8,["textContent"])),e.count?(f(),h("button",{key:2,class:"md-captcha-btn",disabled:e.isCounting,onClick:t[1]||(t[1]=(...t)=>e.sendHandler&&e.sendHandler(...t)),textContent:g(e.countBtnText||e.countNormalText)},null,8,["disabled","textContent"])):v("",!0)])])),_:1},8,["modelValue","maxlength","system","mask","is-view"])])),_:3},8,["modelValue","onShow","onHide"])},B.install=e=>{e.component(B.name,B)};export{B as _};
